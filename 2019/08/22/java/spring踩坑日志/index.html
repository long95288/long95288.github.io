<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title>spring踩坑日志 · 风兮木落</title><meta name="description" content="1、文件上传大小限制问题问题描述:使用application.properties配置文件上传大小限制不起作用
123spring.servlet.multipart.max-request-size=-1spring.servlet.multipart.max-file-size=-1spring"><meta name="og:description" content="1、文件上传大小限制问题问题描述:使用application.properties配置文件上传大小限制不起作用
123spring.servlet.multipart.max-request-size=-1spring.servlet.multipart.max-file-size=-1spring"><meta name="twitter:site" content="风兮木落"><meta name="twitter:title" content="spring踩坑日志"><meta name="twitter:card" content="summary"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 7.3.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="container" id="stage"><div class="row"><div class="col-sm-3 col-xs-12 side-container invisible" id="side-bar"><div class="vertical-text site-title"><h3 class="site-title-small" tabindex="-1"><a class="a-title" href="/">long blogs</a></h3><h1 class="site-title-large" tabindex="-1"><a class="a-title" href="/">进一步有进一步惊喜</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div class="site-title-links" id="site-nav"><ul><li><a href="/">Home</a></li><li><a href="/archives">Archive</a></li><li><a href="/tags">Tags</a></li><li class="soc"><a href="https://long95288.github.io/atom.xml" target="_blank" rel="noopener noreferrer" aria-label="RSS"><i class="fa fa-rss">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2025&nbsp;<a target="_blank" href="https://long95288.github.io" rel="noopener noreferrer">long</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div><div class="col-sm-9 col-xs-12 main-container invisible" id="main-container"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a>spring踩坑日志</a></p><p class="post-meta"><span class="date meta-item">Posted at&nbsp;2019-08-22</span><span class="meta-item"><i class="fa fa-tag"></i><span>&nbsp;</span><a class="a-tag" href="/tags/笔记/" title="笔记">笔记</a><span>&nbsp;</span><a class="a-tag" href="/tags/spring/" title="spring">spring</a><span>&nbsp;</span></span></p><p class="post-abstract"><h4 id="1、文件上传大小限制问题"><a href="#1、文件上传大小限制问题" class="headerlink" title="1、文件上传大小限制问题"></a>1、文件上传大小限制问题</h4><p>问题描述:使用application.properties配置文件上传大小限制不起作用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.servlet.multipart.max-request-size=-<span class="number">1</span></span><br><span class="line">spring.servlet.multipart.max-file-size=-<span class="number">1</span></span><br><span class="line">spring.servlet.multipart.location=/home/trainee/springboot/document</span><br></pre></td></tr></table></figure>
<p>解决办法:新建一个bean的配置<br>可以在启动类中添加如下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MultipartConfigElement <span class="title function_">multipartConfigElement</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">MultipartConfigFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MultipartConfigFactory</span>();</span><br><span class="line">    <span class="comment">// 设置最大文件的大小</span></span><br><span class="line">    factory.setMaxFileSize(DataSize.of(<span class="number">2000</span>, DataUnit.MEGABYTES));</span><br><span class="line">    <span class="comment">// 设置最大请求大小</span></span><br><span class="line">    factory.setMaxRequestSize(DataSize.of(<span class="number">2000</span>,DataUnit.MEGABYTES));</span><br><span class="line">    <span class="keyword">return</span> factory.createMultipartConfig();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2、springBoot跨域请求问题"><a href="#2、springBoot跨域请求问题" class="headerlink" title="2、springBoot跨域请求问题"></a>2、springBoot跨域请求问题</h4><p>使用<code>@CrossOrigin(&quot;*&quot;)</code>无法实现跨域<br>解决办法，在控制层使用如下注解就可以实现跨域<br><code>@CrossOrigin(origins = &quot;*&quot;,allowCredentials = &quot;true&quot;,methods = &#123;&#125;)</code></p>
<h4 id="3、时区出现错误解决办法"><a href="#3、时区出现错误解决办法" class="headerlink" title="3、时区出现错误解决办法"></a>3、时区出现错误解决办法</h4><p>（1）出现连接时区错误<br>（2）插入时间数据时出现错误<br>解决办法：在连接的url之后设置时间属性<br><code>jdbc:mysql://127.0.0.1:3306/trainee?serverTimezone=GMT%2B8</code><br>将时区设置成北京的时区</p>
<h4 id="4、接收前端返回json对象自动打包问题"><a href="#4、接收前端返回json对象自动打包问题" class="headerlink" title="4、接收前端返回json对象自动打包问题"></a>4、接收前端返回json对象自动打包问题</h4><p>需要在接收的处声明<code>@RequestBody</code>才能自动装箱。声明<code>@Valid</code>来验证数据。</p>
<h4 id="5、log4j配置不起作用"><a href="#5、log4j配置不起作用" class="headerlink" title="5、log4j配置不起作用"></a>5、log4j配置不起作用</h4><p>要使用自定义的log,必须将spring boot 中自带的spring.boot.start.logging给去掉。因为logback的优先级比log4j的优先级要高。(后面测试含有logback也可以加载配置文件,玄幻)<br>推荐把依赖包给去掉<br>去除包中的依赖如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--排除logback依赖--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果出现下面的错误,需要检查log4j依赖是否都添加了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.</span><br><span class="line">SLF4J: Defaulting to no-operation (NOP) logger implementation</span><br><span class="line">SLF4J: See https://www.slf4j.org/codes.html#StaticLoggerBinder for further details.</span><br></pre></td></tr></table></figure>
<p>能够运行的依赖如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--日志--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.26<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.26<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果还有错误，可能需要引入common-logging.jar</p>
<h5 id="6、Long-类型传到前端页面的精度丢失问题"><a href="#6、Long-类型传到前端页面的精度丢失问题" class="headerlink" title="6、Long 类型传到前端页面的精度丢失问题"></a>6、Long 类型传到前端页面的精度丢失问题</h5><p>解决办法，将Long类型转换成字符串。传给前端，前端传回去从字符串转成Long类型。可以自己写函数转换。但是有现成的轮子可以用就不必造轮子了。<br>使用阿里的fastjson提供的注解便可以轻松的完成工作了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonSerialize(using = ToStringSerializer.class)</span></span><br><span class="line"><span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>
<h5 id="7、controller返回前端的数据自动转换大小写的问题"><a href="#7、controller返回前端的数据自动转换大小写的问题" class="headerlink" title="7、controller返回前端的数据自动转换大小写的问题"></a>7、controller返回前端的数据自动转换大小写的问题</h5><p> 由于移植了一个net的项目到java。但是,前端的命名不规范,变量全部为大写。但是由于fastjson的自动转换,将本来是大写的的变量变成小写了。</p>
<h6 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h6><p>  由于使用lombok插件,所以不能在get方法上使用<code>@JsonPropertty</code>注解。使用在属性上有一样的效果。<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonProperty(&quot;Name&quot;)</span></span><br><span class="line"><span class="meta">@TableField(&quot;Name&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String Name;</span><br></pre></td></tr></table></figure><br>  返回前端的数据就变成了Name而不是name</p>
<h4 id="8、mybatis-plus忽视某些实体字段。不对数据库进行映射。"><a href="#8、mybatis-plus忽视某些实体字段。不对数据库进行映射。" class="headerlink" title="8、mybatis-plus忽视某些实体字段。不对数据库进行映射。"></a>8、mybatis-plus忽视某些实体字段。不对数据库进行映射。</h4><p>在字段上使用<code>@TableField(exist = false)</code>来忽视该字段对数据库的映射。</p>
<h4 id="9、mybatis-plus-字符串非空更新失败"><a href="#9、mybatis-plus-字符串非空更新失败" class="headerlink" title="9、mybatis-plus 字符串非空更新失败"></a>9、mybatis-plus 字符串非空更新失败</h4><p>问题描述:字符串类型非空更新失败，像密码、邮箱这些作为字符串存储。只是更新其中一部分，会导致没有值的字段更新为空。</p>
<h5 id="解决办法-1"><a href="#解决办法-1" class="headerlink" title="解决办法"></a>解决办法</h5><p>给字段设置更新策略<code>updateStategy = FieldStrategy.NOT_EMPTY</code>。只是对字符起作用，其它的类型会使用<code>updateStategy = FieldStrategy.NOT_NULL</code></p>
</p></div><div class="share"><span>Share</span>&nbsp;<span class="soc"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></span><span class="soc"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></span><span class="soc"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=https://long95288.github.io/2019/08/22/java/spring踩坑日志/%20风兮木落%20spring踩坑日志"></a></span></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/2019/08/23/%E5%89%8D%E7%AB%AF%E8%B7%AF%E7%94%B1/" title="前端路由"><i class="fa fa-angle-double-left"></i>&nbsp;Previous post: 前端路由</a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/2019/08/21/web/javascript%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%B0%8F%E4%B8%9C%E8%A5%BF/" title="javascript实现的小东西">Next post: javascript实现的小东西&nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2025&nbsp;<a target="_blank" href="https://long95288.github.io" rel="noopener noreferrer">long</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>