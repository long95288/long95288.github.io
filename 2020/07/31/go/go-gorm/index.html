<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title>go-gorm · 风兮木落</title><meta name="description" content="官方文档 已经很详细的对gorm的使用方法进行介绍了。
连接数据库123args := &amp;quot;root:root1234@(localhost:3306)/gamedb?charset=utf8mb4&amp;amp;parseTime=True&amp;amp;loc=Local&amp;quot;db,err ="><meta name="og:description" content="官方文档 已经很详细的对gorm的使用方法进行介绍了。
连接数据库123args := &amp;quot;root:root1234@(localhost:3306)/gamedb?charset=utf8mb4&amp;amp;parseTime=True&amp;amp;loc=Local&amp;quot;db,err ="><meta name="twitter:site" content="风兮木落"><meta name="twitter:title" content="go-gorm"><meta name="twitter:card" content="summary"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 7.3.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="container" id="stage"><div class="row"><div class="col-sm-3 col-xs-12 side-container invisible" id="side-bar"><div class="vertical-text site-title"><h3 class="site-title-small" tabindex="-1"><a class="a-title" href="/">long blogs</a></h3><h1 class="site-title-large" tabindex="-1"><a class="a-title" href="/">进一步有进一步惊喜</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div class="site-title-links" id="site-nav"><ul><li><a href="/">Home</a></li><li><a href="/archives">Archive</a></li><li><a href="/tags">Tags</a></li><li class="soc"><a href="https://long95288.github.io/atom.xml" target="_blank" rel="noopener noreferrer" aria-label="RSS"><i class="fa fa-rss">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2025&nbsp;<a target="_blank" href="https://long95288.github.io" rel="noopener noreferrer">long</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div><div class="col-sm-9 col-xs-12 main-container invisible" id="main-container"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a>go-gorm</a></p><p class="post-meta"><span class="date meta-item">Posted at&nbsp;2020-07-31</span><span class="meta-item"><i class="fa fa-tag"></i><span>&nbsp;</span><a class="a-tag" href="/tags/golang/" title="golang">golang</a><span>&nbsp;</span><a class="a-tag" href="/tags/gorm/" title="gorm">gorm</a><span>&nbsp;</span></span></p><p class="post-abstract"><p><a target="_blank" rel="noopener" href="http://gorm.io/zh_CN/docs/index.html">官方文档</a> 已经很详细的对gorm的使用方法进行介绍了。</p>
<h4 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">args := <span class="string">&quot;root:root1234@(localhost:3306)/gamedb?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span></span><br><span class="line">db,err = gorm.Open(<span class="string">&quot;mysql&quot;</span>,args)</span><br><span class="line">db.LogMode(<span class="literal">true</span>) <span class="comment">// 开启日志，会打印sql语句</span></span><br></pre></td></tr></table></figure>
<h4 id="操作数据库"><a href="#操作数据库" class="headerlink" title="操作数据库"></a>操作数据库</h4><h5 id="查询表是否存在"><a href="#查询表是否存在" class="headerlink" title="查询表是否存在"></a>查询表是否存在</h5><p><code>db.HasTable(&amp;user)</code><br><code>db.HasTable(&amp;User&#123;&#125;)</code><br><code>db.HasTable(&quot;users&quot;)</code></p>
<h5 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h5><p><code>db.CreateTable(&amp;user)</code></p>
<h5 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h5><p><code>db.DropTable(&amp;User&#123;&#125;)</code><br><code>db.DropTable(&quot;user&quot;)</code><br><code>db.DropTableIfExist(&amp;User&#123;&#125;,&quot;prodcuts&quot;)</code> &#x2F;&#x2F;删除两张表</p>
<h5 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h5><ul>
<li>修改列<br><code>db.Model(&amp;User).ModifyColumn(&quot;description&quot;,&quot;text&quot;)</code> &#x2F;&#x2F;修改description列为text</li>
<li>删除列<br><code>db.Model(&amp;User&#123;&#125;).DropColumn(&quot;description&quot;)</code></li>
</ul>
<h4 id="操作表数据"><a href="#操作表数据" class="headerlink" title="操作表数据"></a>操作表数据</h4><h5 id="创建数据"><a href="#创建数据" class="headerlink" title="创建数据"></a>创建数据</h5><p><code>db.Create(&amp;user)</code></p>
<h5 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">db.First(&amp;user) <span class="comment">// SELECT * FROM users ORDER BY id LIMIT 1;</span></span><br><span class="line">db.Last(&amp;user) <span class="comment">//  SELECT * FROM users ORDER BY id DESC LIMIT 1;</span></span><br><span class="line">db.Find(&amp;users) <span class="comment">//  SELECT * FROM users;</span></span><br><span class="line">db.First(&amp;user,<span class="number">10</span>) <span class="comment">// SELECT * FROM users WHERE id = 10</span></span><br><span class="line">db.Where(<span class="string">&quot;name = ?&quot;</span>,<span class="string">&quot;jinzhu&quot;</span>).First(&amp;user) <span class="comment">//  SELECT * FROM users WHERE name = &#x27;jinzhu&#x27; limit 1;</span></span><br></pre></td></tr></table></figure>
<p>Where函数里面使用?作为拼接。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Where(<span class="string">&quot;name &lt;&gt; ?&quot;</span>, <span class="string">&quot;jinzhu&quot;</span>)</span><br><span class="line">Where(<span class="string">&quot;name in (?)&quot;</span>, []<span class="type">string</span>&#123;<span class="string">&quot;jinzhu&quot;</span>, <span class="string">&quot;jinzhu 2&quot;</span>&#125;)</span><br><span class="line">Where(<span class="string">&quot;name LIKE ?&quot;</span>, <span class="string">&quot;%jin%&quot;</span>)</span><br><span class="line">Where(<span class="string">&quot;name = ? AND age &gt;= ?&quot;</span>, <span class="string">&quot;jinzhu&quot;</span>, <span class="string">&quot;22&quot;</span>)</span><br><span class="line">Where(<span class="string">&quot;updated_at &gt; ?&quot;</span>, lastWeek)</span><br><span class="line">Where(<span class="string">&quot;created_at BETWEEN ? AND ?&quot;</span>, lastWeek, today)</span><br></pre></td></tr></table></figure>
<p>Struct和map作为查询条件</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Struct</span></span><br><span class="line">db.Where(&amp;User&#123;Name: <span class="string">&quot;jinzhu&quot;</span>, Age: <span class="number">20</span>&#125;).First(&amp;user)</span><br><span class="line"><span class="comment">//// SELECT * FROM users WHERE name = &quot;jinzhu&quot; AND age = 20 LIMIT 1;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Map</span></span><br><span class="line">db.Where(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;jinzhu&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">20</span>&#125;).Find(&amp;users)</span><br><span class="line"><span class="comment">//// SELECT * FROM users WHERE name = &quot;jinzhu&quot; AND age = 20;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 主键的Slice</span></span><br><span class="line">db.Where([]<span class="type">int64</span>&#123;<span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>&#125;).Find(&amp;users)</span><br><span class="line"><span class="comment">//// SELECT * FROM users WHERE id IN (20, 21, 22);</span></span><br></pre></td></tr></table></figure>
<h5 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h5><h5 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h5><h5 id="坑位"><a href="#坑位" class="headerlink" title="坑位"></a>坑位</h5><h5 id="unsupported-Scan-storing-driver-Value-type-uint8-into-type-time-Time"><a href="#unsupported-Scan-storing-driver-Value-type-uint8-into-type-time-Time" class="headerlink" title="unsupported Scan, storing driver.Value type []uint8 into type *time.Time"></a>unsupported Scan, storing driver.Value type []uint8 into type *time.Time</h5><p>解决办法:数据库连接使用<code>parseTime=true</code>便可以解决</p>
</p></div><div class="share"><span>Share</span>&nbsp;<span class="soc"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></span><span class="soc"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></span><span class="soc"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=https://long95288.github.io/2020/07/31/go/go-gorm/%20风兮木落%20go-gorm"></a></span></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/2020/07/31/go/go-%E5%9C%A3%E7%BB%8F-%E7%AC%94%E8%AE%B0/" title="go-圣经-笔记"><i class="fa fa-angle-double-left"></i>&nbsp;Previous post: go-圣经-笔记</a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/2020/07/29/markdown%E7%94%BB%E5%9B%BE/" title="markdown画图">Next post: markdown画图&nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2025&nbsp;<a target="_blank" href="https://long95288.github.io" rel="noopener noreferrer">long</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>